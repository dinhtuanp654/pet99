task.wait(1)
-- Kiểm tra biến toàn cục để xác định script đã chạy hay chưa
if _G.SCRIPT4 then
    warn("Script đã được chạy trước đó!")
    return -- Dừng script nếu đã chạy
end

-- Đánh dấu script đã được chạy
_G.SCRIPT4 = true

-- Script của bạn
repeat
    wait()
until game:IsLoaded()
    and game:GetService("Players").LocalPlayer:FindFirstChild("PlayerGui")
    and game:GetService("Players").LocalPlayer.PlayerGui:FindFirstChild("GUIFX Holder")
    and game:GetService("Players").LocalPlayer.PlayerGui["GUIFX Holder"].DisplayOrder == 999

local rs = game:GetService("ReplicatedStorage")
local VirtualUser = game:service("VirtualUser")
local plr = game:GetService("Players").LocalPlayer
local teleportPoint = Vector3.new(2167.5029, 18.7212, -20845.3730)


game:GetService("Players").LocalPlayer.Idled:Connect(function()
    VirtualUser:CaptureController()
    VirtualUser:ClickButton2(Vector2.new())
end)

local v6 = require(rs.Library.Client.Save)
local megaPoints = tonumber(v6.Get().Christmas2024Part2.MegaPresentPoints)
spawn(function()
    while wait() do
        if tonumber(v6.Get().Christmas2024Part2.MegaPresentPoints) < 9500 then
            for i, v in v6.Get().Inventory.Misc do
                if v.id == "Super Lucky Gingerbread" or v.id == "Lucky Gingerbread" then
                    local b = v._am or 1
                    local maxSubmit = 5000
                    local args = { [1] = { [i] = b } }

                    local c = rs.Network["Mega Present: Submit"]:InvokeServer(unpack(args))
                    if tonumber(b) <= maxSubmit and not c then
                        while b >= 1 do
                            local args = { [1] = { [i] = b } }
                            local success = rs.Network["Mega Present: Submit"]:InvokeServer(unpack(args))
                            if success then
                                break
                            else
                                b = math.floor(b / 1.5)
                            end
                        end
                    else
                        local args = { [1] = { [i] = maxSubmit } }
                        rs.Network["Mega Present: Submit"]:InvokeServer(unpack(args))
                    end
                end
            end
        end
    end
end)
spawn(function()
    while wait() do
        if tonumber(v6.Get().Christmas2024Part2.MegaPresentPoints) < 9500 then
            for i, pet in pairs(v6.Get().Inventory.Pet) do
                if pet.id == "Icy Phoenix" or pet.id == "Lit Octopus" then
                    local a = pet._am or 1
                    local maxSubmit = 5000
                    local args = { [1] = { [i] = a } }

                    local b = rs.Network["Mega Present: Submit"]:InvokeServer(unpack(args))
                    if tonumber(a) <= maxSubmit and not b then
                        while a >= 1 do
                            local args = { [1] = { [i] = a } }
                            local success = rs.Network["Mega Present: Submit"]:InvokeServer(unpack(args))
                            if success then
                                print(a)
                                break
                            else
                                a = math.floor(a / 1.5)
                            end
                        end
                    else
                        local args = { [1] = { [i] = maxSubmit } }
                        rs.Network["Mega Present: Submit"]:InvokeServer(unpack(args))
                    end
                end
            end
        end
    end
end)
while wait() do
    local megaPoints = tonumber(v6.Get().Christmas2024Part2.MegaPresentPoints)
    if plr:DistanceFromCharacter(teleportPoint) >= 100 then
        plr.Character.HumanoidRootPart.CFrame = workspace.__THINGS.Instances.HolidayEvent.Teleports.Enter.CFrame
        task.wait(3)
        plr.Character.HumanoidRootPart.CFrame = CFrame.new(2177.075439453125, 22.129756927490234, -20844.62109375)
    end
    if megaPoints >= 9500 then
        rs.Network["Mega Present: Open"]:InvokeServer()
    end
end
